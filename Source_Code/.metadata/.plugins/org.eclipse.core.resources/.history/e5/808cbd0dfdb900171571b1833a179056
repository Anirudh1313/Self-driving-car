/*
 * obstacle_avoidance.cpp
 *
 *  Created on: Oct 25, 2017
 *      Author: Sucheta
 */

#include "obstacle_avoidance.hpp"
MOTOR_SIGNAL_t obstacle_avoidance(SENSOR_SONARS_t sensor_msg_decoded)
{
	MOTOR_SIGNAL_t obst_avoided_msg;

	/* Ranges: 	Stop range (0): < 20 inches
	 * 			FullLeft/FullRight range (1): 21 - 110 inches
	 * 			SlightLeft/SlightRiht range (2): 111 - 200 inches
	 */
	uint16_t left_range = sensor_msg_decoded.SENSOR_SONARS_left;
	uint16_t middle_range = sensor_msg_decoded.SENSOR_SONARS_middle;
	uint16_t right_range = sensor_msg_decoded.SENSOR_SONARS_right;
	uint16_t rear_range = sensor_msg_decoded.SENSOR_SONARS_rear;

	if(sensor_msg_decoded.SENSOR_SONARS_left <=20  || sensor_msg_decoded.SENSOR_SONARS_middle <=20 ||
			sensor_msg_decoded.SENSOR_SONARS_right <=20)
	{
		obst_avoided_msg.MOTOR_DRIVE_NEUTRAL = 1;
		obst_avoided_msg.MOTOR_STEER_ANGLE = 15.1;
	}
	return obst_avoided_msg;
}
/*
BO_ 200 SENSOR_SONARS: 8 SENSOR
 SG_ SENSOR_SONARS_left : 0|16@1+ (1,0) [0|256] "" DRIVER,IO
 SG_ SENSOR_SONARS_middle : 16|16@1+ (1,0) [0|256] "" DRIVER,IO
 SG_ SENSOR_SONARS_right : 32|16@1+ (1,0) [0|256] "" DRIVER,IO
 SG_ SENSOR_SONARS_rear : 48|16@1+ (1,0) [0|256] "" DRIVER,IO
*/

